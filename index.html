<!DOCTYPE html>
<html>
   <head>
      <meta http-equiv="content-type" content="text/html; charset=UTF-8">
      <title>TF2CutContent's Random Imgur Image Loader</title>
      <style type='text/css'>
         body {
             background-color: #24201B;
             color: #EBE2CA;
             overflow-y: visible;
             font-family: Arial;
         }
         h1 {
             color: #EBE2CA;
         }
         .warning {
             font-weight: bold;
             color: #FE4040;
             font-size: 150%;
         }
         #info {
             color: #EBE2CA;
         }
         #random {
             font-size: 24px;
         }
         #images {
             margin: 20px 0;
         }
         #images a:visited {
             opacity: 0.3;
             display: inline-block;
         }
         #images img {
             margin-right: 5px;
             border: 2px solid #3D362E;
         }
         #images img:hover {
             border: 2px solid #98CDFF;
         }
      </style>
   </head>
   <body>
      <center>
         <h1>TF2CutContent's Random Imgur Image Loader</h1>
         <p><span class="warning">WARNING: YOU WILL ENCOUNTER A LOT OF NSFW CONTENT THROUGH THIS.</span><br>
         <span class="warning">NONE OF THESE IMAGES ARE HOSTED ON THIS SITE.</span><br>
         <span class="warning">IF YOU ENCOUNTER ANY "HIGHLY ILLEGAL" PORNOGRAPHIC MATERIAL, PLEASE SUBMIT A <a href="https://imgur.com/removalrequest" target="_blank">REMOVAL REQUEST</a> TO IMGUR.</span></p>
         <p><button id="random">Load Images</button></p>
         <p id="info"></p>
         <div id="images"></div>
      </center>
      <script type="text/javascript" src="jquery.min.js"></script>
      <script type='text/javascript'>
         // taken from evilinternet(?), original source long gone
         window.num_images = 104;
         window.char_length = 5;
         //window.char_length = 7;
         
         imgurcache = new Array();
         
         jQuery(document).ready(function($) {
         	var info_el = $("#info"),
         		images_el = $("#images");
         	
         	var Imgur = {
         		fetch: function(num) {
         			var self = this,
         				x;
         			
         			self.total = num;
         			self.done = 0;
         			self.failures = 0;
         			self.start =+ new Date;
         			
         			$(images_el).empty();
         			
         			for(x = 0; x < num; x++) {
         				self.hunt(function(id) {
         					self.done++;
         					
         					$(images_el).append("<a href=\"https://i.imgur.com/"+ id +"_d.webp?maxwidth=4000&fidelity=high\" target=\"_blank\" rel=\"noreferrer\"><img src=\"https://i.imgur.com/"+ id +"s.png\" height=\"110\" width=\"110\" /></a>");
         					
         					self.update();
         				});
         			}
         		},
         		update: function() {
         			var interval = (new Date - this.start);
         			
         			function speed(v) {
         				return (~~(v / (interval * 1e5))) / 100;
         			}
         			
         			$(info_el).html( ((this.done < this.total)?"Loading... "+ this.done +"/"+ this.total +" ("+ this.failures +" failures"+") ":"Done. ") + "["+ speed((this.failures + this.done)) +" req/s - "+ speed(this.done) +" img/s]");
         		},
         		
         		hunt: function(cb) {
         			var self = this,
         				id = self.random(window.char_length),
         				img = new Image;
         			
         			function fail() {
         				self.failures++;
         				self.update();
         				self.hunt(cb);
         			}
         			
         			self.update();
         			
         			img.src = "http://i.imgur.com/"+ id +"_d.webp?maxwidth=1001&fidelity=low";
         			
         			img.onload = function() {
                                        // Gotta be a better way to do this.
                                        // Plus, some of the later filtered images aren't being filtered sometimes.
         				if (((img.width == 198) && (img.height == 160)) || ((img.width == 161) && (img.height == 81))) {
         					// assume this is an imgur error image and retry
         					fail();
         				} else if ((img.naturalWidth == 298) && (img.naturalHeight == 256)) {
         					// fuck off monopoly man
         					fail();
         				} else if ((img.naturalWidth <= 32) || (img.naturalHeight <= 32)) {
         					// fuck off tiny images
         					fail();
         				} else if ((img.naturalWidth == 652) && (img.naturalHeight == 470)) {
         					// fuck off cellphone picture
         					fail();
         				} else if ((img.naturalWidth == 225) && (img.naturalHeight == 225)) {
         					// fuck off other cellphone picture
         					fail();
         				} else if ((img.naturalWidth == 399) && (img.naturalHeight == 344)) {
         					// fuck off other other cellphone picture
         					fail();
         				} else if (((img.naturalWidth == 760) && (img.naturalHeight == 756))) {
         					// fuck off iPhone 5 picture
         					fail();
         				} else if (((img.naturalWidth == 500) && (img.naturalHeight == 388))) {
         					// fuck off iPhone 4 picture
         					fail();
         				} else if (((img.naturalWidth == 128) && (img.naturalHeight == 128))) {
         					// fuck off tricolor Facebook logo picture
         					fail();
         				} else if (((img.naturalWidth == 643) && (img.naturalHeight == 88))) {
         					// fuck off wide YouTube header image
         					fail();
         				} else {
         					cb(id);
         				}
         			}
         			
         			img.onerror = fail;
         		},
         		random: function(len) {
         			var text = new Array(),
         				possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",
         				i;
         			
         			for (i = 0; i < len; i++) {
         				imgurchar = possible.charAt(Math.floor((Math.random() * possible.length)));
         				
         				if(-1 == text.indexOf(imgurchar)) {
         					text.push(imgurchar);
         				} else {
         					i--;
         				}
         			}
         			
         			text = text.join("");
         			
         			if(-1 == imgurcache.indexOf(text)) {
         				imgurcache.push(text);
         				
         				return text;
         			} else {
         				self.random(window.char_length);
         				
         				return false;
         			}
         		}
         	};
         	
         	$("#random").on('click', function() {
         		Imgur.fetch(window.num_images);
         	});
         });
      </script>
   </body>
</html>
